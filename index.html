<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Codenames - Online Game</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        html, body {
            height: 100%;
        }
        .card-red { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .card-blue { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .card-neutral { background: linear-gradient(135deg, #f3f4f6, #e5e7eb); }
        .card-assassin { background: linear-gradient(135deg, #1f2937, #111827); }
        .card-revealed { transform: rotateY(180deg); transition: transform 0.6s; }
        .codemaster-overlay { 
            background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.1) 10px, rgba(255,255,255,0.1) 20px);
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        * { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBLyoIoXp2aJCnhFqIFufMVBz0fzCS-FYY",
            authDomain: "game-303eb.firebaseapp.com",
            databaseURL: "https://game-303eb-default-rtdb.firebaseio.com",
            projectId: "game-303eb",
            storageBucket: "game-303eb.firebasestorage.app",
            messagingSenderId: "22261863844",
            appId: "1:22261863844:web:66f8541079b9025ec69d31",
            measurementId: "G-RKN2F3HVHS"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Word list for the game
        const WORD_LIST = [
            "APPLE", "BOOK", "CHAIR", "DOG", "ELEPHANT", "FIRE", "GUITAR", "HOUSE", "ICE", "JUNGLE",
            "KING", "LION", "MOON", "NIGHT", "OCEAN", "PIANO", "QUEEN", "RIVER", "SUN", "TREE",
            "UMBRELLA", "VILLAGE", "WATER", "XRAY", "YELLOW", "ZEBRA", "AIRPLANE", "BRIDGE", "CASTLE", "DIAMOND",
            "ENGINE", "FLOWER", "GARDEN", "HAMMER", "ISLAND", "JACKET", "KITCHEN", "LADDER", "MOUNTAIN", "NEEDLE",
            "ORANGE", "PENCIL", "RABBIT", "SCHOOL", "TIGER", "UNICORN", "VIOLIN", "WINDOW", "YOGURT", "ZIPPER",
            "ANCHOR", "BALLOON", "CAMERA", "DRAGON", "EAGLE", "FOREST", "GHOST", "HELMET", "IGLOO", "JEWEL",
            "KITE", "LEMON", "MIRROR", "NINJA", "OCTOPUS", "PARROT", "QUILT", "ROBOT", "SNAKE", "TORNADO",
            "UNICYCLE", "VOLCANO", "WHALE", "XEROX", "YACHT", "ZEPPELIN", "ARROW", "BOTTLE", "CLOUD", "DESERT",
            "EARTH", "FEATHER", "GLOBE", "HONEY", "IRON", "JELLY", "KNIFE", "LIGHT", "MAGIC", "NORTH",
            "OWL", "PAPER", "QUICK", "RAIN", "STAR", "THUNDER", "UNDER", "VOICE", "WIND", "EXTRA"
        ];

        // Translations
        const translations = {
            en: {
                startGame: "Start Game",
                giveClue: "Give Clue",
                endTurn: "End Turn",
                copyRoomLink: "Copy Room Link",
                joinRoom: "Join Room",
                createRoom: "Create Room",
                playerName: "Player Name",
                roomCode: "Room Code",
                redTeam: "Red Team",
                blueTeam: "Blue Team",
                codemaster: "Codemaster",
                player: "Player",
                spectator: "Spectator",
                waiting: "Waiting for players...",
                yourTurn: "Your Turn",
                opponentTurn: "Opponent's Turn",
                gameOver: "Game Over",
                winner: "Winner",
                clueWord: "Clue Word",
                clueNumber: "Number",
                guessesLeft: "Guesses Left",
                chat: "Chat",
                sendMessage: "Send Message"
            },
            ar: {
                startGame: "ابدأ اللعبة",
                giveClue: "أعطِ تلميحاً",
                endTurn: "إنهاء الدور",
                copyRoomLink: "نسخ رابط الغرفة",
                joinRoom: "انضم للغرفة",
                createRoom: "إنشاء غرفة",
                playerName: "اسم اللاعب",
                roomCode: "رمز الغرفة",
                redTeam: "الفريق الأحمر",
                blueTeam: "الفريق الأزرق",
                codemaster: "القائد",
                player: "لاعب",
                spectator: "مشاهد",
                waiting: "في انتظار اللاعبين...",
                yourTurn: "دورك",
                opponentTurn: "دور الخصم",
                gameOver: "انتهت اللعبة",
                winner: "الفائز",
                clueWord: "كلمة التلميح",
                clueNumber: "الرقم",
                guessesLeft: "التخمينات المتبقية",
                chat: "الدردشة",
                sendMessage: "إرسال رسالة"
            }
        };

        // Utility functions
        const generateRoomCode = () => {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let result = '';
            for (let i = 0; i < 4; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        };

        const generateBoard = () => {
            const shuffledWords = [...WORD_LIST].sort(() => Math.random() - 0.5).slice(0, 25);
            const startingTeam = Math.random() < 0.5 ? 'red' : 'blue';
            
            const cardTypes = [];
            // Starting team gets 9 cards, other team gets 8
            for (let i = 0; i < 9; i++) cardTypes.push(startingTeam);
            for (let i = 0; i < 8; i++) cardTypes.push(startingTeam === 'red' ? 'blue' : 'red');
            for (let i = 0; i < 7; i++) cardTypes.push('neutral');
            cardTypes.push('assassin');
            
            // Shuffle card types
            cardTypes.sort(() => Math.random() - 0.5);
            
            return {
                words: shuffledWords.map((word, index) => ({
                    text: word,
                    type: cardTypes[index],
                    revealed: false
                })),
                startingTeam,
                remaining: {
                    red: startingTeam === 'red' ? 9 : 8,
                    blue: startingTeam === 'blue' ? 9 : 8
                }
            };
        };

        // Main App Component
        function CodenamesApp() {
            const [currentView, setCurrentView] = useState('home');
            const [language, setLanguage] = useState('en');
            const [playerName, setPlayerName] = useState('');
            const [playerId, setPlayerId] = useState('');
            const [roomData, setRoomData] = useState(null);
            const [roomCode, setRoomCode] = useState('');
            const [gameState, setGameState] = useState(null);

            const t = translations[language];

            useEffect(() => {
                // Generate unique player ID
                setPlayerId('player_' + Math.random().toString(36).substr(2, 9));
            }, []);

            const createRoom = async () => {
                if (!playerName.trim()) return;
                
                const newRoomCode = generateRoomCode();
                const roomRef = database.ref(`rooms/${newRoomCode}`);
                
                const newRoom = {
                    createdAt: Date.now(),
                    hostId: playerId,
                    roomCode: newRoomCode,
                    settings: {
                        language: language,
                        private: false,
                        maxPlayers: 8
                    },
                    players: {
                        [playerId]: {
                            name: playerName,
                            team: 'spectator',
                            role: 'player',
                            joinedAt: Date.now(),
                            isReady: false,
                            connectionStatus: 'online'
                        }
                    },
                    gameState: 'waiting',
                    chat: []
                };

                await roomRef.set(newRoom);
                setRoomCode(newRoomCode);
                setCurrentView('lobby');
                
                // Listen to room changes
                roomRef.on('value', (snapshot) => {
                    setRoomData(snapshot.val());
                });
            };

            const joinRoom = async (code) => {
                if (!playerName.trim() || !code.trim()) return;
                
                const roomRef = database.ref(`rooms/${code}`);
                const snapshot = await roomRef.once('value');
                
                if (!snapshot.exists()) {
                    alert('Room not found!');
                    return;
                }

                await roomRef.child(`players/${playerId}`).set({
                    name: playerName,
                    team: 'spectator',
                    role: 'player',
                    joinedAt: Date.now(),
                    isReady: false,
                    connectionStatus: 'online'
                });

                setRoomCode(code);
                setCurrentView('lobby');
                
                // Listen to room changes
                roomRef.on('value', (snapshot) => {
                    setRoomData(snapshot.val());
                });
            };

            const startGame = async () => {
                if (!roomData || roomData.hostId !== playerId) return;
                
                const board = generateBoard();
                const roomRef = database.ref(`rooms/${roomCode}`);
                
                await roomRef.update({
                    board: board,
                    turn: {
                        currentTeam: board.startingTeam,
                        phase: 'clue',
                        currentClue: null,
                        guessesLeft: 0
                    },
                    gameState: 'in_progress'
                });
                
                setCurrentView('game');
            };

            if (currentView === 'home') {
                return <HomeView 
                    t={t} 
                    language={language}
                    setLanguage={setLanguage}
                    playerName={playerName}
                    setPlayerName={setPlayerName}
                    createRoom={createRoom}
                    joinRoom={joinRoom}
                    roomCode={roomCode}
                    setRoomCode={setRoomCode}
                />;
            }

            if (currentView === 'lobby') {
                return <LobbyView 
                    t={t}
                    roomData={roomData}
                    playerId={playerId}
                    roomCode={roomCode}
                    startGame={startGame}
                    setCurrentView={setCurrentView}
                />;
            }

            if (currentView === 'game') {
                return <GameView 
                    t={t}
                    roomData={roomData}
                    playerId={playerId}
                    roomCode={roomCode}
                />;
            }

            return null;
        }

        // Home View Component
        function HomeView({ t, language, setLanguage, playerName, setPlayerName, createRoom, joinRoom, roomCode, setRoomCode }) {
            const [joinRoomCode, setJoinRoomCode] = useState('');

            return (
                <div className="min-h-full bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center p-4">
                    <div className="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
                        <div className="text-center mb-8">
                            <h1 className="text-4xl font-bold text-gray-800 mb-2">Codenames</h1>
                            <p className="text-gray-600">Online Multiplayer Game</p>
                        </div>

                        <div className="mb-6">
                            <label className="block text-sm font-medium text-gray-700 mb-2">Language</label>
                            <select 
                                value={language} 
                                onChange={(e) => setLanguage(e.target.value)}
                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            >
                                <option value="en">English</option>
                                <option value="ar">العربية</option>
                            </select>
                        </div>

                        <div className="mb-6">
                            <label className="block text-sm font-medium text-gray-700 mb-2">{t.playerName}</label>
                            <input
                                type="text"
                                value={playerName}
                                onChange={(e) => setPlayerName(e.target.value)}
                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                placeholder="Enter your name"
                                maxLength={20}
                            />
                        </div>

                        <div className="space-y-4">
                            <button
                                onClick={createRoom}
                                disabled={!playerName.trim()}
                                className="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-lg transition-colors"
                            >
                                {t.createRoom}
                            </button>

                            <div className="relative">
                                <div className="absolute inset-0 flex items-center">
                                    <div className="w-full border-t border-gray-300"></div>
                                </div>
                                <div className="relative flex justify-center text-sm">
                                    <span className="px-2 bg-white text-gray-500">or</span>
                                </div>
                            </div>

                            <div className="space-y-3">
                                <input
                                    type="text"
                                    value={joinRoomCode}
                                    onChange={(e) => setJoinRoomCode(e.target.value.toUpperCase())}
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                    placeholder={t.roomCode}
                                    maxLength={6}
                                />
                                <button
                                    onClick={() => joinRoom(joinRoomCode)}
                                    disabled={!playerName.trim() || !joinRoomCode.trim()}
                                    className="w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-semibold py-3 px-6 rounded-lg transition-colors"
                                >
                                    {t.joinRoom}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Lobby View Component
        function LobbyView({ t, roomData, playerId, roomCode, startGame, setCurrentView }) {
            const isHost = roomData?.hostId === playerId;
            const currentPlayer = roomData?.players?.[playerId];

            const changeTeam = async (team) => {
                const roomRef = database.ref(`rooms/${roomCode}/players/${playerId}`);
                await roomRef.update({ team });
            };

            const changeRole = async (role) => {
                const roomRef = database.ref(`rooms/${roomCode}/players/${playerId}`);
                await roomRef.update({ role });
            };

            const copyRoomLink = () => {
                navigator.clipboard.writeText(`${window.location.origin}?room=${roomCode}`);
                alert('Room link copied!');
            };

            if (!roomData) return <div className="flex items-center justify-center min-h-full">Loading...</div>;

            const players = Object.entries(roomData.players || {});
            const redPlayers = players.filter(([_, player]) => player.team === 'red');
            const bluePlayers = players.filter(([_, player]) => player.team === 'blue');
            const spectators = players.filter(([_, player]) => player.team === 'spectator');

            return (
                <div className="min-h-full bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-2xl p-6 mb-6">
                            <div className="flex justify-between items-center mb-6">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-800">Room: {roomCode}</h1>
                                    <p className="text-gray-600">Waiting for players to join...</p>
                                </div>
                                <button
                                    onClick={copyRoomLink}
                                    className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"
                                >
                                    {t.copyRoomLink}
                                </button>
                            </div>

                            <div className="grid md:grid-cols-3 gap-6">
                                {/* Red Team */}
                                <div className="bg-red-50 rounded-xl p-4">
                                    <h3 className="text-xl font-semibold text-red-800 mb-4 flex items-center">
                                        <div className="w-4 h-4 bg-red-600 rounded-full mr-2"></div>
                                        {t.redTeam} ({redPlayers.length})
                                    </h3>
                                    <div className="space-y-2">
                                        {redPlayers.map(([id, player]) => (
                                            <div key={id} className="flex items-center justify-between bg-white p-2 rounded-lg">
                                                <span className="font-medium">{player.name}</span>
                                                <span className="text-sm bg-red-100 text-red-800 px-2 py-1 rounded">
                                                    {player.role === 'codemaster' ? t.codemaster : t.player}
                                                </span>
                                            </div>
                                        ))}
                                    </div>
                                    {currentPlayer?.team !== 'red' && (
                                        <button
                                            onClick={() => changeTeam('red')}
                                            className="w-full mt-3 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors"
                                        >
                                            Join Red Team
                                        </button>
                                    )}
                                </div>

                                {/* Blue Team */}
                                <div className="bg-blue-50 rounded-xl p-4">
                                    <h3 className="text-xl font-semibold text-blue-800 mb-4 flex items-center">
                                        <div className="w-4 h-4 bg-blue-600 rounded-full mr-2"></div>
                                        {t.blueTeam} ({bluePlayers.length})
                                    </h3>
                                    <div className="space-y-2">
                                        {bluePlayers.map(([id, player]) => (
                                            <div key={id} className="flex items-center justify-between bg-white p-2 rounded-lg">
                                                <span className="font-medium">{player.name}</span>
                                                <span className="text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded">
                                                    {player.role === 'codemaster' ? t.codemaster : t.player}
                                                </span>
                                            </div>
                                        ))}
                                    </div>
                                    {currentPlayer?.team !== 'blue' && (
                                        <button
                                            onClick={() => changeTeam('blue')}
                                            className="w-full mt-3 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors"
                                        >
                                            Join Blue Team
                                        </button>
                                    )}
                                </div>

                                {/* Spectators */}
                                <div className="bg-gray-50 rounded-xl p-4">
                                    <h3 className="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                                        <div className="w-4 h-4 bg-gray-600 rounded-full mr-2"></div>
                                        Spectators ({spectators.length})
                                    </h3>
                                    <div className="space-y-2">
                                        {spectators.map(([id, player]) => (
                                            <div key={id} className="flex items-center justify-between bg-white p-2 rounded-lg">
                                                <span className="font-medium">{player.name}</span>
                                            </div>
                                        ))}
                                    </div>
                                    {currentPlayer?.team !== 'spectator' && (
                                        <button
                                            onClick={() => changeTeam('spectator')}
                                            className="w-full mt-3 bg-gray-600 hover:bg-gray-700 text-white py-2 rounded-lg transition-colors"
                                        >
                                            Spectate
                                        </button>
                                    )}
                                </div>
                            </div>

                            {/* Role Selection */}
                            {currentPlayer?.team !== 'spectator' && (
                                <div className="mt-6 p-4 bg-gray-50 rounded-xl">
                                    <h4 className="font-semibold mb-3">Your Role:</h4>
                                    <div className="flex gap-3">
                                        <button
                                            onClick={() => changeRole('player')}
                                            className={`px-4 py-2 rounded-lg transition-colors ${
                                                currentPlayer?.role === 'player' 
                                                ? 'bg-green-600 text-white' 
                                                : 'bg-white border border-gray-300 hover:bg-gray-50'
                                            }`}
                                        >
                                            {t.player}
                                        </button>
                                        <button
                                            onClick={() => changeRole('codemaster')}
                                            className={`px-4 py-2 rounded-lg transition-colors ${
                                                currentPlayer?.role === 'codemaster' 
                                                ? 'bg-purple-600 text-white' 
                                                : 'bg-white border border-gray-300 hover:bg-gray-50'
                                            }`}
                                        >
                                            {t.codemaster}
                                        </button>
                                    </div>
                                </div>
                            )}

                            {/* Start Game Button */}
                            {isHost && (
                                <div className="mt-6 text-center">
                                    <button
                                        onClick={startGame}
                                        disabled={redPlayers.length === 0 || bluePlayers.length === 0}
                                        className="bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-semibold py-3 px-8 rounded-lg transition-colors text-lg"
                                    >
                                        {t.startGame}
                                    </button>
                                    {(redPlayers.length === 0 || bluePlayers.length === 0) && (
                                        <p className="text-sm text-gray-600 mt-2">Need players in both teams to start</p>
                                    )}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        // Game View Component
        function GameView({ t, roomData, playerId, roomCode }) {
            const [clueWord, setClueWord] = useState('');
            const [clueNumber, setClueNumber] = useState(1);
            const [chatMessage, setChatMessage] = useState('');

            if (!roomData || !roomData.board) return <div className="flex items-center justify-center min-h-full">Loading game...</div>;

            const currentPlayer = roomData.players[playerId];
            const isCodemaster = currentPlayer?.role === 'codemaster';
            const playerTeam = currentPlayer?.team;
            const currentTeam = roomData.turn?.currentTeam;
            const isPlayerTurn = playerTeam === currentTeam && !isCodemaster;
            const isCodemasterTurn = playerTeam === currentTeam && isCodemaster && roomData.turn?.phase === 'clue';

            const revealCard = async (cardIndex) => {
                if (!isPlayerTurn || roomData.turn?.phase !== 'guess') return;
                
                const card = roomData.board.words[cardIndex];
                if (card.revealed) return;

                const roomRef = database.ref(`rooms/${roomCode}`);
                const updates = {};
                
                // Reveal the card
                updates[`board/words/${cardIndex}/revealed`] = true;
                
                // Update remaining counts
                if (card.type === 'red') {
                    updates['board/remaining/red'] = roomData.board.remaining.red - 1;
                } else if (card.type === 'blue') {
                    updates['board/remaining/blue'] = roomData.board.remaining.blue - 1;
                }
                
                // Check win conditions
                if (card.type === 'assassin') {
                    updates['gameState'] = 'finished';
                    updates['winner'] = currentTeam === 'red' ? 'blue' : 'red';
                } else if (card.type === 'red' && roomData.board.remaining.red === 1) {
                    updates['gameState'] = 'finished';
                    updates['winner'] = 'red';
                } else if (card.type === 'blue' && roomData.board.remaining.blue === 1) {
                    updates['gameState'] = 'finished';
                    updates['winner'] = 'blue';
                } else {
                    // Continue turn or switch teams
                    if (card.type === currentTeam) {
                        // Correct guess, decrease guesses left
                        const newGuessesLeft = Math.max(0, (roomData.turn?.guessesLeft || 1) - 1);
                        updates['turn/guessesLeft'] = newGuessesLeft;
                        
                        if (newGuessesLeft === 0) {
                            // End turn
                            updates['turn/currentTeam'] = currentTeam === 'red' ? 'blue' : 'red';
                            updates['turn/phase'] = 'clue';
                            updates['turn/currentClue'] = null;
                        }
                    } else {
                        // Wrong guess, end turn
                        updates['turn/currentTeam'] = currentTeam === 'red' ? 'blue' : 'red';
                        updates['turn/phase'] = 'clue';
                        updates['turn/currentClue'] = null;
                    }
                }
                
                await roomRef.update(updates);
            };

            const giveClue = async () => {
                if (!isCodemasterTurn || !clueWord.trim() || clueNumber < 1) return;
                
                const roomRef = database.ref(`rooms/${roomCode}`);
                await roomRef.update({
                    'turn/currentClue': {
                        word: clueWord.toUpperCase(),
                        number: clueNumber,
                        giverId: playerId,
                        timestamp: Date.now()
                    },
                    'turn/phase': 'guess',
                    'turn/guessesLeft': clueNumber + 1
                });
                
                setClueWord('');
                setClueNumber(1);
            };

            const endTurn = async () => {
                if (!isPlayerTurn) return;
                
                const roomRef = database.ref(`rooms/${roomCode}`);
                await roomRef.update({
                    'turn/currentTeam': currentTeam === 'red' ? 'blue' : 'red',
                    'turn/phase': 'clue',
                    'turn/currentClue': null
                });
            };

            const sendChatMessage = async () => {
                if (!chatMessage.trim()) return;
                
                const roomRef = database.ref(`rooms/${roomCode}/chat`);
                await roomRef.push({
                    senderId: playerId,
                    name: currentPlayer.name,
                    message: chatMessage,
                    timestamp: Date.now()
                });
                
                setChatMessage('');
            };

            return (
                <div className="min-h-full bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 p-4">
                    <div className="max-w-7xl mx-auto">
                        {/* Header */}
                        <div className="bg-white rounded-xl shadow-lg p-4 mb-6">
                            <div className="flex justify-between items-center">
                                <div className="flex items-center space-x-6">
                                    <h1 className="text-2xl font-bold">Room: {roomCode}</h1>
                                    <div className="flex items-center space-x-4">
                                        <div className="flex items-center">
                                            <div className="w-3 h-3 bg-red-600 rounded-full mr-2"></div>
                                            <span className="font-medium">{roomData.board.remaining.red}</span>
                                        </div>
                                        <div className="flex items-center">
                                            <div className="w-3 h-3 bg-blue-600 rounded-full mr-2"></div>
                                            <span className="font-medium">{roomData.board.remaining.blue}</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="text-right">
                                    <div className={`text-lg font-semibold ${currentTeam === 'red' ? 'text-red-600' : 'text-blue-600'}`}>
                                        {currentTeam === 'red' ? t.redTeam : t.blueTeam}'s Turn
                                    </div>
                                    {roomData.turn?.currentClue && (
                                        <div className="text-sm text-gray-600">
                                            Clue: {roomData.turn.currentClue.word} ({roomData.turn.currentClue.number})
                                        </div>
                                    )}
                                    {roomData.turn?.guessesLeft > 0 && (
                                        <div className="text-sm text-gray-600">
                                            {t.guessesLeft}: {roomData.turn.guessesLeft}
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>

                        <div className="grid lg:grid-cols-4 gap-6">
                            {/* Game Board */}
                            <div className="lg:col-span-3">
                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <div className="grid grid-cols-5 gap-3 aspect-square max-w-2xl mx-auto">
                                        {roomData.board.words.map((card, index) => (
                                            <button
                                                key={index}
                                                onClick={() => revealCard(index)}
                                                disabled={!isPlayerTurn || roomData.turn?.phase !== 'guess' || card.revealed}
                                                className={`
                                                    relative aspect-square rounded-lg font-semibold text-sm transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500
                                                    ${card.revealed 
                                                        ? `card-${card.type} text-white shadow-lg` 
                                                        : 'bg-amber-100 hover:bg-amber-200 text-gray-800 border-2 border-amber-300'
                                                    }
                                                    ${isCodemaster && !card.revealed ? `codemaster-overlay card-${card.type}` : ''}
                                                    ${!isPlayerTurn || roomData.turn?.phase !== 'guess' ? 'cursor-not-allowed' : 'cursor-pointer'}
                                                `}
                                                aria-label={`Card ${index + 1}: ${card.text}${card.revealed ? ` - ${card.type}` : ''}`}
                                            >
                                                <span className="absolute inset-0 flex items-center justify-center p-1 text-center leading-tight">
                                                    {card.text}
                                                </span>
                                            </button>
                                        ))}
                                    </div>
                                </div>

                                {/* Controls */}
                                <div className="mt-6 bg-white rounded-xl shadow-lg p-6">
                                    {isCodemasterTurn && (
                                        <div className="flex items-center space-x-4">
                                            <input
                                                type="text"
                                                value={clueWord}
                                                onChange={(e) => setClueWord(e.target.value)}
                                                placeholder={t.clueWord}
                                                className="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                maxLength={20}
                                            />
                                            <input
                                                type="number"
                                                value={clueNumber}
                                                onChange={(e) => setClueNumber(Math.max(1, parseInt(e.target.value) || 1))}
                                                min="1"
                                                max="9"
                                                className="w-20 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                            />
                                            <button
                                                onClick={giveClue}
                                                disabled={!clueWord.trim() || clueNumber < 1}
                                                className="bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white px-6 py-3 rounded-lg font-semibold transition-colors"
                                            >
                                                {t.giveClue}
                                            </button>
                                        </div>
                                    )}

                                    {isPlayerTurn && roomData.turn?.phase === 'guess' && (
                                        <div className="text-center">
                                            <button
                                                onClick={endTurn}
                                                className="bg-red-600 hover:bg-red-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors"
                                            >
                                                {t.endTurn}
                                            </button>
                                        </div>
                                    )}

                                    {!isPlayerTurn && !isCodemasterTurn && (
                                        <div className="text-center text-gray-600">
                                            {roomData.turn?.phase === 'clue' ? 'Waiting for clue...' : 'Waiting for guesses...'}
                                        </div>
                                    )}
                                </div>
                            </div>

                            {/* Sidebar */}
                            <div className="space-y-6">
                                {/* Players List */}
                                <div className="bg-white rounded-xl shadow-lg p-4">
                                    <h3 className="font-semibold mb-4">Players</h3>
                                    <div className="space-y-2">
                                        {Object.entries(roomData.players || {}).map(([id, player]) => (
                                            <div key={id} className={`p-2 rounded-lg ${player.team === 'red' ? 'bg-red-50' : player.team === 'blue' ? 'bg-blue-50' : 'bg-gray-50'}`}>
                                                <div className="font-medium">{player.name}</div>
                                                <div className="text-xs text-gray-600">
                                                    {player.role === 'codemaster' ? t.codemaster : t.player}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                {/* Chat */}
                                <div className="bg-white rounded-xl shadow-lg p-4">
                                    <h3 className="font-semibold mb-4">{t.chat}</h3>
                                    <div className="h-48 overflow-y-auto mb-4 space-y-2">
                                        {(roomData.chat || []).map((msg, index) => (
                                            <div key={index} className="text-sm">
                                                <span className="font-medium text-blue-600">{msg.name}:</span>
                                                <span className="ml-2">{msg.message}</span>
                                            </div>
                                        ))}
                                    </div>
                                    <div className="flex space-x-2">
                                        <input
                                            type="text"
                                            value={chatMessage}
                                            onChange={(e) => setChatMessage(e.target.value)}
                                            onKeyPress={(e) => e.key === 'Enter' && sendChatMessage()}
                                            placeholder={t.sendMessage}
                                            className="flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                                            maxLength={100}
                                        />
                                        <button
                                            onClick={sendChatMessage}
                                            className="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg transition-colors text-sm"
                                        >
                                            Send
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Game Over Modal */}
                        {roomData.gameState === 'finished' && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                                <div className="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
                                    <div className="text-center">
                                        <h2 className="text-3xl font-bold mb-4">{t.gameOver}</h2>
                                        <div className={`text-2xl font-semibold mb-6 ${roomData.winner === 'red' ? 'text-red-600' : 'text-blue-600'}`}>
                                            {roomData.winner === 'red' ? t.redTeam : t.blueTeam} Wins!
                                        </div>
                                        <button
                                            onClick={() => window.location.reload()}
                                            className="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors"
                                        >
                                            Play Again
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<CodenamesApp />, document.getElementById('root'));
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98c14062b7ef5cea',t:'MTc2MDA0ODI4Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
